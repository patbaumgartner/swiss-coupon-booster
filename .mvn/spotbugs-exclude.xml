<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!-- Suppress EI_EXPOSE_REP warnings for BrowserContextHandle -->
    <!-- These are Playwright objects that are meant to be used and shared -->
    <Match>
        <Class name="com.patbaumgartner.couponbooster.coop.service.BrowserContextHandle"/>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2"/>
    </Match>

    <!-- Suppress PATH_TRAVERSAL_IN for CoopBrowserFactory -->
    <!-- The userDataDir is from configuration, not user input -->
    <Match>
        <Class name="com.patbaumgartner.couponbooster.coop.service.CoopBrowserFactory"/>
        <Bug pattern="PATH_TRAVERSAL_IN"/>
    </Match>

    <!-- Suppress EI_EXPOSE_REP2 for MigrosCouponBoosterRunner -->
    <!-- Spring-managed beans are meant to be injected and shared -->
    <Match>
        <Class name="com.patbaumgartner.couponbooster.migros.runner.MigrosCouponBoosterRunner"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <!-- Suppress CRLF_INJECTION_LOGS warnings -->
    <!-- Configuration values and exception messages are trusted, not user input -->
    <Match>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>

    <!-- Suppress IMPROPER_UNICODE warnings for cookie parsing -->
    <!-- Cookie parsing follows HTTP standards and handles Unicode appropriately -->
    <Match>
        <Class name="com.patbaumgartner.couponbooster.util.cookie.CookieParser"/>
        <Bug pattern="IMPROPER_UNICODE"/>
    </Match>

    <Match>
        <Class name="com.patbaumgartner.couponbooster.util.cookie.SameSite"/>
        <Bug pattern="IMPROPER_UNICODE"/>
    </Match>

    <Match>
        <Class name="com.patbaumgartner.couponbooster.migros.service.CumulusCouponService"/>
        <Bug pattern="IMPROPER_UNICODE"/>
    </Match>
</FindBugsFilter>
